
================================================================================
🔧 COMPREHENSIVE SELF-TEST SUITE
================================================================================

📁 TEST 1: File Operations
----------------------------------------
→ Writing test file via FileWriter...
   ✅ Wrote file to: /home/gespitia/projects/anki-ocr-agent/agent_self_test.txt
   📏 File size: 116 bytes
→ Reading test file via FileReader...
   📖 Read 110 characters
   📝 Content preview: 'agent self-test: comprehensive check\nLine 2: UTF-8 encoding test: áéíóú ñ\nLine 3: timestamp=17553775'...
   ✅ File write/read integrity: PASSED

📂 TEST 2: Directory and File Discovery
----------------------------------------
→ Current directory contains 6 files:
   📄 .gitignore (553 bytes)
   📄 README.md (12790 bytes)
   📄 agent_output.txt (0 bytes)
   📄 agent_self_test.txt (116 bytes)
   📄 anki_cards.csv (114 bytes)
   📄 vocab_ocr_agent.py (5665 bytes)
→ Input directory 'input' found
   📁 Contains 1 total files
   🖼️  Found 1 image files:
      🖼️  vocabulary_page.png (4341616 bytes, 4239.9 KB)

📋 TEST 3: YAML Processing
----------------------------------------
→ Testing YAML to Anki conversion...
   📝 Test YAML (248 chars):
   - word: test
     back: 'A trial or examination ("I took a test", "This is a test case", "Testing is important")'
     tags: noun
   - word: example...
   ✅ Generated CSV: /home/gespitia/projects/anki-ocr-agent/anki_cards.csv
   📊 CSV contains 3 lines (including header)
   📄 CSV preview: Word,Back,Tags
                   test,"A trial or examination (""I took a test"", ""This is a...

🖼️  TEST 4: Image Processing Validation
----------------------------------------
→ Target image file found: input/vocabulary_page.png
   📏 Size: 4341616 bytes (4239.9 KB)
   📅 Modified: 1754759148.4514978
   🔍 File header: ffd8ffe14bdd4578696600004d4d002a...
   ✅ Detected as JPEG image

📝 TEST 5: YAML Syntax Validation
----------------------------------------
→ Testing YAML with embedded quotes...
   ✅ Successfully processed YAML with quotes: /home/gespitia/projects/anki-ocr-agent/anki_cards.csv

================================================================================
🏁 SELF-TEST COMPLETE
================================================================================

🖼️  Processing image: input/vocabulary_page.png
🤖 Creating vocabulary processing agent...
Local tool instances: ['yaml_to_anki', 'file_reader', 'file_writer']
Agent created. Tools reported by agent (best-effort):
['yaml_to_anki', 'file_reader', 'file_writer', 'final_answer']

🚀 Starting agent execution...
╭───────────────────────────────────────────────────────────────────────────────── New run ─────────────────────────────────────────────────────────────────────────────────╮
│                                                                                                                                                                           │
│ EXAMINE THIS SPECIFIC IMAGE: input/vocabulary_page.png                                                                                                                    │
│                                                                                                                                                                           │
│ 🔍 LOOK AT THE IMAGE AND TELL ME:                                                                                                                                         │
│ - What vocabulary words do you actually see?                                                                                                                              │
│ - What definitions are visible?                                                                                                                                           │
│ - What example sentences are shown?                                                                                                                                       │
│                                                                                                                                                                           │
│ 🚫 DO NOT USE PLACEHOLDER TEXT like:                                                                                                                                      │
│ - 'real_word_you_see'                                                                                                                                                     │
│ - 'actual_word_from_image'                                                                                                                                                │
│ - 'example_word'                                                                                                                                                          │
│                                                                                                                                                                           │
│ ✅ EXTRACT ONLY REAL WORDS YOU CAN READ                                                                                                                                   │
│                                                                                                                                                                           │
│                                                                                                                                                                           │
│ You are a Vision Language Model examining a vocabulary image. You can see the image directly.                                                                             │
│                                                                                                                                                                           │
│ CRITICAL: You MUST actually look at the image and read the real text content.                                                                                             │
│                                                                                                                                                                           │
│ STEP 1: EXAMINE THE IMAGE                                                                                                                                                 │
│ Look at the provided image file and identify:                                                                                                                             │
│ - What vocabulary words are actually visible?                                                                                                                             │
│ - What definitions or meanings are shown?                                                                                                                                 │
│ - What example sentences (if any) are present?                                                                                                                            │
│ - What is the actual text content you can read?                                                                                                                           │
│                                                                                                                                                                           │
│ STEP 2: EXTRACT REAL CONTENT ONLY                                                                                                                                         │
│ DO NOT use placeholder words like:                                                                                                                                        │
│ - "real_word_you_see"                                                                                                                                                     │
│ - "actual_word_from_image"                                                                                                                                                │
│ - "example_word"                                                                                                                                                          │
│ - Any made-up content                                                                                                                                                     │
│                                                                                                                                                                           │
│ STEP 3: FORMAT AND CALL TOOL                                                                                                                                              │
│ Create YAML with the actual words you see, then call yaml_to_anki.                                                                                                        │
│                                                                                                                                                                           │
│ Example of what you should do:                                                                                                                                            │
│ <code>                                                                                                                                                                    │
│ # I can see these words in the image: [list actual words\]                                                                                                                │
│ # The definitions shown are: [actual definitions\]                                                                                                                        │
│ yaml_content = '''- word: [actual_word_from_image\]                                                                                                                       │
│   back: '[actual_definition\] ("[actual_example_1\]", "[actual_example_2\]")'                                                                                             │
│   tags: [actual_grammar_type\]'''                                                                                                                                         │
│ yaml_to_anki(yaml_content)                                                                                                                                                │
│ </code>                                                                                                                                                                   │
│                                                                                                                                                                           │
│ IF YOU CANNOT SEE THE IMAGE: Say "I cannot see or read the image content clearly" instead of making up content.                                                           │
│                                                                                                                                                                           │
│ NO IMPORTS ALLOWED - yaml_to_anki tool is already available.                                                                                                              │
│                                                                                                                                                                           │
│ Additional constraints:                                                                                                                                                   │
│ - DO NOT import anything (import statements are banned)                                                                                                                   │
│ - DO NOT use words like apple, banana, cat, dog unless they're actually in the image                                                                                      │
│ - DO NOT assume content with comments like "Assuming the image contains..."                                                                                               │
│ - DO NOT create placeholder/sample data                                                                                                                                   │
│ - If you cannot read the image, admit it rather than creating fake content.                                                                                               │
│                                                                                                                                                                           │
│                                                                                                                                                                           │
│ Now examine the image and describe what vocabulary you actually see, then extract it.                                                                                     │
│                                                                                                                                                                           │
╰─ LiteLLMModel - ollama_chat/qwen2.5vl:latest ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Step 1 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 ─ Executing parsed code: ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 
  # I cannot see or read the image content clearly                                                                                                                           
 ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 
Out: None
[Step 1: Duration 5.07 seconds| Input tokens: 2,596 | Output tokens: 58]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Step 2 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 ─ Executing parsed code: ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 
  # I cannot see or read the image content clearly                                                                                                                           
 ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 
Out: None
[Step 2: Duration 3.25 seconds| Input tokens: 5,317 | Output tokens: 127]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Step 3 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 ─ Executing parsed code: ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 
  # I cannot see or read the image content clearly                                                                                                                           
 ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 
Out: None
[Step 3: Duration 3.37 seconds| Input tokens: 8,174 | Output tokens: 196]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Step 4 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 ─ Executing parsed code: ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 
  # I cannot see or read the image content clearly                                                                                                                           
 ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 
Out: None
[Step 4: Duration 3.56 seconds| Input tokens: 11,167 | Output tokens: 265]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Step 5 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 ─ Executing parsed code: ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 
  # I cannot see or read the image content clearly                                                                                                                           
 ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── 
Out: None
[Step 5: Duration 3.41 seconds| Input tokens: 14,296 | Output tokens: 334]
Reached max steps.
[Step 6: Duration 5.79 seconds| Input tokens: 15,974 | Output tokens: 448]

✅ Agent execution completed!
Agent run returned: Thought: Since I cannot actually see the image, I will have to rely on the description provided in the task. The image contains vocabulary words, definitions, and example sentences. However, I cannot extract the actual content from the image as it is not available.

<code>
# I cannot see or read the image content clearly
</code>
Calling tools:
[{'id': 'call_6', 'type': 'function', 'function': {'name': 'python_interpreter', 'arguments': '# I cannot see or read the image content clearly'}}]
📊 Generated CSV with 2 lines (including header)
📄 Output file: /home/gespitia/projects/anki-ocr-agent/anki_cards.csv

📋 Generated vocabulary preview:
   Header: Word,Back,Tags
   Word 1: test

✅ Content appears to be real vocabulary (no obvious placeholder text detected)
